<ng-template #complex let-display let-data="data" let-key="valueKey">
    {{display[key]}}
</ng-template>
<ng-template #primitive let-display>
    {{display}}
</ng-template>
<ng-template #empty>
    <span>The list is empty</span>
</ng-template>
<ng-template #addItem>

    There are no items to be displayed.
    <div style="border: 1px dashed #3f3f3f;" (click)="addItemToCollection()">Add Item</div>

</ng-template>
<ng-template #headerItemBase let-item let-key="valueKey" let-groupKey="groupKey">
   {{ item[key] }}
</ng-template>

<div class="igx-combo" [style.width]="width">
    <div style="display: flex; flex-direction: row; align-items: flex-end; align-content: space-between;">
        <div style="width: 80%">
            <igx-input-group>
                <input igxInput name="comboInput" type="text" [(ngModel)]="value" width="90%" readonly/>
            </igx-input-group>
        </div>
        <span style="width: 10%; vertical-align: middle; text-align: center;
        background-color: #a3a3a3; border: transparent; border-radius: 50%; color: #3f3f3f" (click)="deselectAllItems()">
            x
        </span>
        <button (click)="dropdown.toggle()" igxRipple style="width: 10%;">{{dropdown.collapsed ? "V" : "^"}}</button>
    </div>
    <ng-container *ngIf="!dropdown.collapsed">
        <igx-input-group>
            <input igxInput #searchInput [igxDropDownItemNavigation]="dropdown" name="searchInput" type="text" [(ngModel)]="searchValue" (keyup)="handleKeyDown($event)" placeholder="Enter a search term"
            />
        </igx-input-group>
        <div>
            Select All:
            <igx-checkbox #selectAllCheckbox (change)="handleSelectAll($event)"></igx-checkbox>
        </div>
    </ng-container>
    <igx-combo-drop-down #igxComboDropDown>
        <ng-container *ngIf="!dropdown.collapsed">
            <ng-container *ngTemplateOutlet="dropdownHeader; context: {$impicit: this}">
            </ng-container>
        </ng-container>
        <ng-container *ngIf="!dropdown.collapsed">

            <div style="position: relative;">
                <ng-template igxFor let-item [igxForOf]="data | comboFiltering:filteringExpressions:filteringLogic:caller:pipeTrigger" [igxForScrollOrientation]="'vertical'"
                    [igxForContainerSize]="listHeight" [igxForItemSize]="listItemHeight">
                    <igx-combo-item [itemData]="item" isHeader={{item.isHeader}}>
                        <ng-container *ngIf="!item.isHeader">
                            <igx-checkbox [checked]="isItemSelected(item)" disableRipple="true" disabled="true"></igx-checkbox>
                        </ng-container>
                        <ng-container *ngIf="item.isHeader">
                            <ng-container *ngTemplateOutlet="headerItemTemplate ? headerItemTemplate : headerItemBase; context: {$implicit: item, data: data, valueKey: valueKey, groupKey: groupKey}"></ng-container>
                        </ng-container>
                        <ng-container *ngIf="!item.isHeader">
                            <ng-container #listItem *ngTemplateOutlet="template; context: {$implicit: item, data: data, valueKey: valueKey};"></ng-container>
                        </ng-container>
                    </igx-combo-item>
                </ng-template>
            </div>
            <div *ngIf="filteredData.length === 0" style="text-align: center;">
                <ng-container *ngTemplateOutlet="addItemTemplate ? addItemTemplate : addItem; context: {$impicit: this}">


                </ng-container>
            </div>
        </ng-container>
        <ng-container *ngIf="!dropdown.collapsed">
            <ng-container *ngTemplateOutlet="dropdownFooter; context: {$impicit: this}"></ng-container>
        </ng-container>
    </igx-combo-drop-down>
</div>